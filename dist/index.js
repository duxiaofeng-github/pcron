function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r,n,a=e(require("dayjs")),t=e(require("dayjs/plugin/weekOfYear")),i=e(require("dayjs/plugin/weekday"));a.extend(t),a.extend(i),function(e){e[e.Year=0]="Year",e[e.Month=1]="Month",e[e.Day=2]="Day",e[e.Hour=3]="Hour",e[e.Min=4]="Min",e[e.Sec=5]="Sec",e[e.WeekOfYear=6]="WeekOfYear",e[e.Weekday=7]="Weekday",e[e.WeekOfMonth=8]="WeekOfMonth"}(n||(n={}));var u=((r={})[n.Year]=void 0,r[n.Month]=[1,12],r[n.Day]=[1,31],r[n.Hour]=[0,23],r[n.Min]=[0,59],r[n.Sec]=[0,59],r[n.WeekOfYear]=[1,52],r[n.WeekOfMonth]=[1,4],r[n.Weekday]=[0,6],r);function s(e,r){return"*"===e?[]:e.split(",").map(function(e){var n=e.split("-"),a=n[1],t=parseInt(n[0]),i=parseInt(a);if(!function(e,r,n){if(isNaN(e)||isNaN(r))return!1;var a=u[n];return null==a||e>=a[0]&&r<=a[1]}(t,i,r))throw new Error("Invalid range "+t+"-"+i+" in");return{start:t,end:i}})}function o(e){var r=e.month,a=e.weekOfYear,t=e.weekOfMonth,i=e.weekday,u=e.day,o=e.hour,c=e.min,h=e.sec;return{period:e.period,year:s(e.year,n.Year),month:null!=r?s(r,n.Month):void 0,weekOfYear:null!=a?s(a,n.WeekOfYear):void 0,weekOfMonth:null!=t?s(t,n.WeekOfMonth):void 0,weekday:null!=i?s(i,n.Weekday):void 0,day:null!=u?s(u,n.Day):void 0,hour:s(o,n.Hour),min:s(c,n.Min),sec:s(h,n.Sec)}}function c(e,r,a,t){var i=t?a.start:a.end;switch(r){case n.Sec:return e.second(i);case n.Min:return e.minute(i);case n.Hour:return e.hour(i);case n.Day:return e.date(i);case n.Weekday:return e.weekday(i);case n.WeekOfMonth:var u=e.weekday();return e.startOf("month").week(i).weekday(u);case n.WeekOfYear:return e.week(i);case n.Month:return e.month(i);case n.Year:return e.year(i)}}function h(e,r){for(var n=0,a=!1,t=0;t<r.length;t++){n=t;var i=r[t],u=r[t-1];if(e>=i.start&&e<=i.end){a=!0;break}if(null!=u&&e>u.end&&e<i.start)break}return{rangeIndex:n,inRange:a}}function d(e,r,a,t,i,u){var s,o=a.weekOfMonth,h=a.day,d=t[i+1];if(null!=d)return c(r,e,d,u);switch(e){case n.Sec:s=n.Min;break;case n.Min:s=n.Hour;break;case n.Hour:s=null!=h?n.Day:n.Weekday;break;case n.Day:s=n.Month;break;case n.Weekday:s=null!=o?n.WeekOfMonth:n.WeekOfYear;break;case n.WeekOfMonth:case n.WeekOfYear:case n.Month:s=n.Year;break;case n.Year:return null}if(s){var f=k(s,r,a,u),l=u?t[0]:t[t.length-1];if(null!=f&&l)return c(f,e,l,u)}return null}function f(e,r){switch(r){case n.Sec:return e.second();case n.Min:return e.minute();case n.Hour:return e.hour();case n.Day:return e.date();case n.Weekday:return e.weekday();case n.WeekOfMonth:return parseInt(e.format("w"))-parseInt(e.startOf("M").format("w"))+1;case n.WeekOfYear:return e.week();case n.Month:return e.month();case n.Year:return e.year()}}function k(e,r,a,t){void 0===t&&(t=!0);var i=r,u=a.period,s=f(r,e),o=function(e,r){var a=e.year,t=e.month,i=e.weekOfYear,u=e.weekOfMonth,s=e.weekday,o=e.day,c=e.hour,h=e.min,d=e.sec;switch(r){case n.Sec:return d;case n.Min:return h;case n.Hour:return c;case n.Day:return o;case n.Weekday:return s;case n.WeekOfMonth:return u;case n.WeekOfYear:return i;case n.Month:return t;case n.Year:return a}}(a,e);if(o&&o.length){var c=h(s,o),k=c.rangeIndex;if(c.inRange){var l=function(e,r){var a,t,i=e.replace("P","").split("T"),u=i[0],s=i[1],o=void 0===s?"":s;switch(r){case n.Sec:a=o.match(/(\d+)[s]/i),t="second";break;case n.Min:a=o.match(/(\d+)[m]/i),t="minute";break;case n.Hour:a=o.match(/(\d+)[h]/i),t="hour";break;case n.Day:case n.Weekday:case n.WeekOfMonth:case n.WeekOfYear:a=u.match(/(\d+)[d]/i),t="day";break;case n.Month:a=u.match(/(\d+)[m]/i),t="month";break;case n.Year:a=u.match(/(\d+)[y]/i),t="year"}return a?{periodNumber:parseInt(a[1]),opUnit:t}:{periodNumber:NaN,opUnit:t}}(u,e),y=l.periodNumber,m=l.opUnit,p=h(f(i=t?r.add(y,m):r.subtract(y,m),e),o);p.inRange||(i=d(e,i,a,o,p.rangeIndex,t))}else i=d(e,r,a,o,k,t)}return i}var l=function(){function e(e,r){this.hasPrev=!0,this.hasNext=!0,this.options=e,this.originalTimestamp=r,this.currentTime=a.unix(r)}var r=e.prototype;return r.reset=function(){this.currentTime=a.unix(this.originalTimestamp)},r.prev=function(){if(!this.hasPrev)return null;var e=k(n.Sec,this.currentTime,this.options);return this.hasPrev=null!=e,null!=e&&(this.currentTime=e),e},r.next=function(){if(!this.hasNext)return null;var e=k(n.Sec,this.currentTime,this.options,!0);return this.hasNext=null!=e,null!=e&&(this.currentTime=e),e},e}();exports.parseExpression=function(e,r){var n,a=e.split(" ");if(function(e){return-1!==e.indexOf("/")}(e))if(function(e){return 5===e.length}(a)){var t=a[0],i=a[1],u=a[3],s=a[4],c=a[5],h=a[2].split("/");n=o({period:t,year:i,weekOfYear:h[0],weekday:h[1],hour:u,min:s,sec:c})}else{var d=a[0],f=a[1],k=a[2],y=a[4],m=a[5],p=a[6],v=a[3].split("/");n=o({period:d,year:f,month:k,weekOfMonth:v[0],weekday:v[1],hour:y,min:m,sec:p})}else{var M=e.split(" ");n=o({period:M[0],year:M[1],month:M[2],day:M[3],hour:M[4],min:M[5],sec:M[6]})}return new l(n,r)};
//# sourceMappingURL=index.js.map
