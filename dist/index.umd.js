!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("dayjs"),require("dayjs/plugin/weekOfYear"),require("dayjs/plugin/weekday")):"function"==typeof define&&define.amd?define(["exports","dayjs","dayjs/plugin/weekOfYear","dayjs/plugin/weekday"],r):r((e=e||self).pcron={},e.dayjs,e.weekOfYear,e.weekday)}(this,function(e,r,n,a){var t,i;r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,r.extend(n),r.extend(a),function(e){e[e.Year=0]="Year",e[e.Month=1]="Month",e[e.Day=2]="Day",e[e.Hour=3]="Hour",e[e.Min=4]="Min",e[e.Sec=5]="Sec",e[e.WeekOfYear=6]="WeekOfYear",e[e.Weekday=7]="Weekday",e[e.WeekOfMonth=8]="WeekOfMonth"}(i||(i={}));var u=((t={})[i.Year]=void 0,t[i.Month]=[1,12],t[i.Day]=[1,31],t[i.Hour]=[0,23],t[i.Min]=[0,59],t[i.Sec]=[0,59],t[i.WeekOfYear]=[1,52],t[i.WeekOfMonth]=[1,4],t[i.Weekday]=[0,6],t);function o(e,r){return"*"===e?[]:e.split(",").map(function(e){var n=e.split("-"),a=n[1],t=parseInt(n[0]),i=parseInt(a);if(!function(e,r,n){if(isNaN(e)||isNaN(r))return!1;var a=u[n];return null==a||e>=a[0]&&r<=a[1]}(t,i,r))throw new Error("Invalid range "+t+"-"+i+" in");return{start:t,end:i}})}function s(e){var r=e.month,n=e.weekOfYear,a=e.weekOfMonth,t=e.weekday,u=e.day,s=e.hour,c=e.min,d=e.sec;return{period:e.period,year:o(e.year,i.Year),month:null!=r?o(r,i.Month):void 0,weekOfYear:null!=n?o(n,i.WeekOfYear):void 0,weekOfMonth:null!=a?o(a,i.WeekOfMonth):void 0,weekday:null!=t?o(t,i.Weekday):void 0,day:null!=u?o(u,i.Day):void 0,hour:o(s,i.Hour),min:o(c,i.Min),sec:o(d,i.Sec)}}function c(e,r,n,a){var t=a?n.start:n.end;switch(r){case i.Sec:return e.second(t);case i.Min:return e.minute(t);case i.Hour:return e.hour(t);case i.Day:return e.date(t);case i.Weekday:return e.weekday(t);case i.WeekOfMonth:var u=e.weekday();return e.startOf("month").week(t).weekday(u);case i.WeekOfYear:return e.week(t);case i.Month:return e.month(t);case i.Year:return e.year(t)}}function d(e,r){for(var n=0,a=!1,t=0;t<r.length;t++){n=t;var i=r[t],u=r[t-1];if(e>=i.start&&e<=i.end){a=!0;break}if(null!=u&&e>u.end&&e<i.start)break}return{rangeIndex:n,inRange:a}}function f(e,r,n,a,t,u){var o,s=n.weekOfMonth,d=n.day,f=a[t+1];if(null!=f)return c(r,e,f,u);switch(e){case i.Sec:o=i.Min;break;case i.Min:o=i.Hour;break;case i.Hour:o=null!=d?i.Day:i.Weekday;break;case i.Day:o=i.Month;break;case i.Weekday:o=null!=s?i.WeekOfMonth:i.WeekOfYear;break;case i.WeekOfMonth:case i.WeekOfYear:case i.Month:o=i.Year;break;case i.Year:return null}if(o){var h=l(o,r,n,u),k=u?a[0]:a[a.length-1];if(null!=h&&k)return c(h,e,k,u)}return null}function h(e,r){switch(r){case i.Sec:return e.second();case i.Min:return e.minute();case i.Hour:return e.hour();case i.Day:return e.date();case i.Weekday:return e.weekday();case i.WeekOfMonth:return parseInt(e.format("w"))-parseInt(e.startOf("M").format("w"))+1;case i.WeekOfYear:return e.week();case i.Month:return e.month();case i.Year:return e.year()}}function l(e,r,n,a){void 0===a&&(a=!0);var t=r,u=n.period,o=h(r,e),s=function(e,r){var n=e.year,a=e.month,t=e.weekOfYear,u=e.weekOfMonth,o=e.weekday,s=e.day,c=e.hour,d=e.min,f=e.sec;switch(r){case i.Sec:return f;case i.Min:return d;case i.Hour:return c;case i.Day:return s;case i.Weekday:return o;case i.WeekOfMonth:return u;case i.WeekOfYear:return t;case i.Month:return a;case i.Year:return n}}(n,e);if(s&&s.length){var c=d(o,s),l=c.rangeIndex;if(c.inRange){var k=function(e,r){var n,a,t=e.replace("P","").split("T"),u=t[0],o=t[1],s=void 0===o?"":o;switch(r){case i.Sec:n=s.match(/(\d+)[s]/i),a="second";break;case i.Min:n=s.match(/(\d+)[m]/i),a="minute";break;case i.Hour:n=s.match(/(\d+)[h]/i),a="hour";break;case i.Day:case i.Weekday:case i.WeekOfMonth:case i.WeekOfYear:n=u.match(/(\d+)[d]/i),a="day";break;case i.Month:n=u.match(/(\d+)[m]/i),a="month";break;case i.Year:n=u.match(/(\d+)[y]/i),a="year"}return n?{periodNumber:parseInt(n[1]),opUnit:a}:{periodNumber:NaN,opUnit:a}}(u,e),y=k.periodNumber,p=k.opUnit,m=d(h(t=a?r.add(y,p):r.subtract(y,p),e),s);m.inRange||(t=f(e,t,n,s,m.rangeIndex,a))}else t=f(e,r,n,s,l,a)}return t}var k=function(){function e(e,n){this.hasPrev=!0,this.hasNext=!0,this.options=e,this.originalTimestamp=n,this.currentTime=r.unix(n)}var n=e.prototype;return n.reset=function(){this.currentTime=r.unix(this.originalTimestamp)},n.prev=function(){if(!this.hasPrev)return null;var e=l(i.Sec,this.currentTime,this.options);return this.hasPrev=null!=e,null!=e&&(this.currentTime=e),e},n.next=function(){if(!this.hasNext)return null;var e=l(i.Sec,this.currentTime,this.options,!0);return this.hasNext=null!=e,null!=e&&(this.currentTime=e),e},e}();e.parseExpression=function(e,r){var n,a=e.split(" ");if(function(e){return-1!==e.indexOf("/")}(e))if(function(e){return 5===e.length}(a)){var t=a[0],i=a[1],u=a[3],o=a[4],c=a[5],d=a[2].split("/");n=s({period:t,year:i,weekOfYear:d[0],weekday:d[1],hour:u,min:o,sec:c})}else{var f=a[0],h=a[1],l=a[2],y=a[4],p=a[5],m=a[6],O=a[3].split("/");n=s({period:f,year:h,month:l,weekOfMonth:O[0],weekday:O[1],hour:y,min:p,sec:m})}else{var w=e.split(" ");n=s({period:w[0],year:w[1],month:w[2],day:w[3],hour:w[4],min:w[5],sec:w[6]})}return new k(n,r)}});
//# sourceMappingURL=index.umd.js.map
